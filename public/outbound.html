<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Outbound Call</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        margin: 24px;
      }
      form {
        max-width: 480px;
        display: grid;
        gap: 14px;
      }
      label {
        display: grid;
        gap: 6px;
        font-weight: 600;
      }
      input, button {
        padding: 10px;
        font: inherit;
      }
      button {
        cursor: pointer;
      }
      pre {
        margin-top: 16px;
        background: #f6f6f6;
        padding: 12px;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <h1>Start Outbound Call</h1>

    <form id="callForm">
      <label>
        To (required)
        <input name="to" placeholder="+15551234567" required />
      </label>

      <label>
        First Name
        <input name="firstName" placeholder="John" />
      </label>

      <label>
        Last Name
        <input name="lastName" placeholder="Doe" />
      </label>

      <label>
        Date of Birth
        <input name="dob" placeholder="YYYY-MM-DD" />
      </label>

      <button type="submit">Start Call</button>
    </form>

    <pre id="output"></pre>

    <script>
      const API_URL = "https://voiceai.tradewindsapp.com/outbound/call";

      document.getElementById("callForm").addEventListener("submit", async (e) => {
        e.preventDefault();

        const form = e.target;
        const payload = {
          to: form.to.value,
          firstName: form.firstName.value || undefined,
          lastName: form.lastName.value || undefined,
          dob: form.dob.value || undefined
        };

        // Remove empty fields so req.body matches your server logic
        Object.keys(payload).forEach(
          key => payload[key] === undefined && delete payload[key]
        );

        const output = document.getElementById("output");
        output.textContent = "Sending request...\n\n" + JSON.stringify(payload, null, 2);

        try {
          const res = await fetch(API_URL, {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify(payload)
          });

          const text = await res.text();
          output.textContent += `\n\nStatus: ${res.status}\nResponse:\n${text}`;
        } catch (err) {
          output.textContent += "\n\nError:\n" + err.message;
        }
      });
    </script>
  </body>
</html>
